<html>
  <head>
    <link rel="stylesheet" href="css/Burner.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="css/Flora.min.css" type="text/css" charset="utf-8" />
    <script src="scripts/Burner.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="scripts/Flora.min.js" type="text/javascript" charset="utf-8"></script>
  </head>
  <body>


    <script src='http://localhost:1337/socket.io/socket.io.js'></script>
    <script type="text/javascript">

      var socket = io.connect('http://localhost:1337');
      var lastVal,
          channel1 = document.getElementById('channel1'),
          channel2 = document.getElementById('channel2'),
          attractorLeft, attractorRight;

      var world = new Burner.World(document.body, {
        gravity: new Burner.Vector(),
        c: 0
      });

      Burner.System.init(function() {

        attractorLeft = this.add('Attractor', {
          mass: 1000,
          location: function () {
            return new Burner.Vector(120, this.world.height / 2 - 60);
          }
        });

        attractorRight = this.add('Attractor', {
          mass: 1000,
          location: function () {
            return new Burner.Vector(this.world.width - 120,this.world.height / 2 + 60);
          }
        });

        for (var i = 0; i < 20; i++) {
          this.add('Agent', {
            flocking: true
          });
        }
      }, world);

      socket.on('connected', function() {
        console.log('connected');
      });

      socket.on('data', function(data) {

        if (lastVal == 1) {
          console.log(data);
          attractorLeft.mass = Flora.Utils.map(data, 0, 6000, 1000, 10000);
        } else if (lastVal == 2) {
          attractorRight.mass = Flora.Utils.map(data, 0, 6000, 1000, 10000);
        }
        lastVal = data;
      });

    </script>

  </body>
</html>
